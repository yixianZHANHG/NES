angular.module("myApp",["ionic","myApp.httpFactory","myApp.slideBox","myApp.tabs","myApp.news","myApp.live","myApp.topic","myApp.personal","myApp.my","myApp.newCon","myApp.lunb"]).config(["$stateProvider","$urlRouterProvider","$ionicConfigProvider",function(e,o,t){t.views.transition("ios"),t.tabs.position("bottom"),t.navBar.alignTitle("center"),t.tabs.style("standard"),e.state("tabs",{url:"/tabs",abstract:!0,templateUrl:"tabs.html",controller:"tabsController"}),o.otherwise("tabs/news")}]),angular.module("myApp.live",[]).config(["$stateProvider",function(e){e.state("tabs.live",{url:"/live",views:{"tabs-live":{templateUrl:"live.html",controller:"liveController"}}})}]).controller("liveController",["$scope","LuboService",function(e,o){}]),angular.module("myApp.my",[]).config(["$stateProvider",function(e){e.state("tabs.my",{url:"/my",views:{"tabs-personal":{templateUrl:"my.html",controller:"myController"}}})}]).controller("myController",["$scope",function(e){e.duSome=function(){console.log("jhhhhjeqwe")}}]),angular.module("myApp.newCon",[]).config(["$stateProvider",function(e){e.state("newCon",{url:"/newCon",templateUrl:"newCon.html",controller:"newConController",params:{data:null}})}]).controller("newConController",["$scope","$stateParams","$sce","HttpFactory",function(e,o,t,n){e.newCon={detail:"",body:""};var l=o.data;console.log(l);var r="http://c.m.163.com/nc/article/"+l+"/full.html";n.getData(r).then(function(o){e.newCon.detail=o,console.log(e.newCon.detail);var t=e.newCon.detail;if(t.img&&t.img.length)for(var n=0;n<t.img.length;n++){var l=t.img[n].pixel.split("*")[0];l>document.body.offsetWidth&&(l=document.body.offsetWidth);var r="width:"+l+"px",i="<img style='"+r+"' src="+t.img[n].src+">";t.body=t.body.replace(t.img[n].ref,i),console.log(t.body)}})}]),angular.module("myApp.news",[]).config(["$stateProvider",function(e){e.state("tabs.news",{url:"/news",views:{"tabs-news":{templateUrl:"news.html",controller:"newsController"}}})}]).controller("newsController",["$scope","$ionicPopup","$state","$ionicViewSwitcher","HttpFactory","$ionicLoading","$ionicScrollDelegate",function(e,o,t,n,l,r,i){var a="http://c.m.163.com/nc/topicset/ios/subscribe/manage/listspecial.html";l.getData(a).then(function(o){e.numArry=o}),e.news={newsArray:"",adsArray:[]};var a="http://c.3g.163.com/recommend/getSubDocPic?tid=T1348647909107&from=toutiao&offset=0&size=10";l.getData(a).then(function(o){e.news.newsArray=o,e.news.adsArray=o[0].ads}),e.items=[];var s=10;e.isShowInfinite=!0,e.loadMore=function(){s+=5;var o="http://c.m.163.com/recommend/getSubDocPic?from=toutiao&prog=LMA1&open=&openpath=&fn=1&passport=&devId=%2BnrKMbpU9ZDPUOhb9gvookO3HKJkIOzrIg%2BI9FhrLRStCu%2B7ZneFbZ30i61TL9kY&offset="+s+"&size=10&version=17.1&spever=false&net=wifi&lat=&lon=&ts=1480666192&sign=yseE2FNVWcJVjhvP48U1nPHyzZCKpBKh%2BaOhOE2d6GR48ErR02zJ6%2FKXOnxX046I&encryption=1&canal=appstore";console.log(s),s<=40?l.getData(o).then(function(o){e.items=e.items.concat(o),console.log(2222222),e.$broadcast("scroll.infiniteScrollComplete")}):(e.isShowInfinite=!1,console.log("到底啦!!"))},e.items=[],e.doRefresh=function(){var o="http://c.m.163.com/recommend/getSubDocPic?from=toutiao&offset=0&size=10";l.getData(o).then(function(o){e.items=o,console.log(11111),e.isShowInfinite=!0,s=10}).finally(function(){e.$broadcast("scroll.refreshComplete")})},e.scrollMainToTop=function(){i.$getByHandle("mainScroll").scrollTop()},e.doSome=function(o){var l=e.items[o].docid;console.log(l),t.go("newCon",{data:l}),n.nextDirection("forward")}}]),angular.module("myApp.personal",[]).config(["$stateProvider",function(e){e.state("tabs.personal",{url:"/personal",views:{"tabs-personal":{templateUrl:"personal.html",controller:"personalController"}}})}]).controller("personalController",["$scope",function(e){}]),angular.module("myApp.tabs",[]).controller("tabsController",["$scope",function(e){e.$on("$stateChangeSuccess",function(e,o,t){var n=function(e){document.getElementsByTagName("body")[0];document.title=e;var o=document.createElement("iframe");o.setAttribute("src","../empty.png"),o.addEventListener("load",function(){setTimeout(function(){document.body.removeChild(o)})}),document.body.appendChild(o)};switch(o.url){case"/news":n("新闻");break;case"/live":n("直播");break;case"/topic":n("话题");break;case"/personal":n("我的")}})}]),angular.module("myApp.topic",[]).config(["$stateProvider",function(e){e.state("tabs.topic",{url:"/topic",views:{"tabs-topic":{templateUrl:"topic.html",controller:"topicController"}}})}]).controller("topicController",["$scope",function(e){}]),angular.module("myApp.httpFactory",[]).factory("HttpFactory",["$http","$q",function(e,o){return{getData:function(t,n){if(t){var l=o.defer();return t="http://localhost:3000/?myUrl="+encodeURIComponent(t),n=n?n:"GET",e({url:t,method:n,timeout:2e4}).then(function(e){e=e.data,e=e[Object.keys(e)[0]],l.resolve(e)},function(e){l.reject(e)}),l.promise}}}}]),angular.module("myApp.lunb",[]).service("LuboService",[function(e){this.getClassify=function(){return[{name:"热门"},{name:"分类"},{name:"订阅"}]}}]),angular.module("myApp.slideBox",[]).directive("mgSlideBox",[function(){return{restrict:"E",scope:{sourceArray:"="},template:'<div class="topCarousel"><ion-slide-box delegate-handle="topCarouselSlideBox" on-slide-changed="slideHasChanged($index)" auto-play="true" slide-interval="1000" show-pager="true" does-continue="true" ng-if="isShowSlideBox" on-drag="drag($event)"> <ion-slide ng-repeat="ads in sourceArray track by $index" ng-click="goToDetailView($index)"><img ng-src="{{ads.imgsrc}}" class="topCarouselImg"></ion-slide> </ion-slide-box><div class="slideBottomDiv"></div></div>',controller:["$scope","$element","$ionicSlideBoxDelegate",function(e,o,t){e.goToDetailView=function(e){console.log("进入详情页"+e)};var n=o[0].lastElementChild;e.$watch("sourceArray",function(o,t){o&&o.length&&(e.isShowSlideBox=!0,n.innerText=e.sourceArray[0].title)}),e.slideHasChanged=function(e){},t.$getByHandle("mainSlideBox").enableSlide(!1),e.drag=function(e){t.$getByHandle("mainSlideBox").enableSlide(!1),e.stopPropagation()}}],replace:!0,link:function(e,o,t){}}}]);